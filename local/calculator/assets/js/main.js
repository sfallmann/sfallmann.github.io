var Calculator=Calculator||function(){"use strict";function t(t,r){return t+r}function r(t,r){return t-r}function n(t,r){return t*r}function e(t,r){return t/r}function u(t){return t/100}function i(t){return t.replace(d,function(t){var r=Number(t.substring(0,t.length-1));return String(u(r))})}function c(t){return f(t.replace(p,function(t){var r=t.split("^"),n=Number(r[0]),e=Number(r[1]);return String(Math.pow(n,e))}))}function o(t){return f(t.replace(s,function(t){var r,u,i,c;return/x/.test(t)?(r=t.split("x"),c=n):(r=t.split("/"),c=e),u=Number(r[0]),i=Number(r[1]),String(c(u,i))}))}function l(n){return f(n.replace(g,function(n){var e,u,i,c;return/\+/.test(n)?(e=n.split("+"),c=t):(e=n.split("-"),c=r),u=Number(e[0]),i=Number(e[1]),String(c(u,i))}))}function a(t){if(/\./.test(t)){var r=t.split("."),n=Number(r[0]),e=Number(Number("0."+r[1]).toPrecision(5));t=String(n+e)}return t}function f(t){return m.exec(t)?a(t):(t=i(t),p.test(t)?c(t):s.test(t)?o(t):g.test(t)?l(t):void 0)}var d=(new RegExp(/\-\-/g),new RegExp(/\-{0,1}\d*\.{0,1}\d*%/g)),p=new RegExp(/\-{0,1}\d*\.{0,1}\d*\^\d*/),s=new RegExp(/\-{0,1}\d*\.{0,1}\d*[\/x]\-{0,1}\d*\.{0,1}\d*/),g=new RegExp(/\-{0,1}\d*\.{0,1}\d*[\+\-]\-{0,1}\d*\.{0,1}\d*/),m=new RegExp(/^\-{0,1}\d*\.{0,1}\d*$/),v={};return v.calculate=function(t){return f(t)},v.operators=function(){return["%","^","x","/","+","-","="]},v}();!function(t){"use strict";function r(r){var n=t(r).data("value");return void 0===n?"":n}function n(t){var r=new RegExp(/[\+\-\/\^x]/),n=new RegExp(/^\-{0,1}\d*\.{0,1}\d*$/),u=(new RegExp(/\d/),new RegExp(/[\d\-\.]/)),i=e.html(),c=i[i.length-1];if(!i&&!u.test(t))return!1;if(!("."!==c&&"%"!==c||"."!==t&&"%"!==t))return!1;if(r.test(c)&&(r.test(t)||"%"===t))return!1;var o=i.match(n);return"."!==t||!o||o[o.length-1].indexOf(".")===-1}var e=t("#output"),u=t("#buttons td");e.html(""),u.on("click",function(t){var u=r(t.target);if("="===u)return void e.html(Calculator.calculate(e.html()));if("C"===u){var i=e.html().split("");return i.pop(),void e.html(i.join(""))}if("R"===u)return void e.html("");n(u)&&e.html(e.html()+String(u))})}(jQuery);